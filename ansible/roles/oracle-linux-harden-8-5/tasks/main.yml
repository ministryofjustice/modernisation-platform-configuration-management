---
###############################################################################
#
# Ansible Playbook for DISA STIG for Oracle Linux 8
#
# Profile Description:
# This profile contains configuration checks that align to the
# DISA STIG for Oracle Linux 8 V1R6.
#
# Profile ID:  xccdf_org.ssgproject.content_profile_stig
# Benchmark ID:  xccdf_org.ssgproject.content_benchmark_OL-8
# Benchmark Version:  0.1.66
# XCCDF Version:  1.2
#
# This file was generated by OpenSCAP 1.3.6 using:
# $ oscap xccdf generate fix --profile xccdf_org.ssgproject.content_profile_stig --fix-type ansible xccdf-file.xml
#
# This Ansible Playbook is generated from an OpenSCAP profile without preliminary evaluation.
# It attempts to fix every selected rule, even if the system is already compliant.
#
# How to apply this Ansible Playbook:
# $ ansible-playbook -i "localhost," -c local playbook.yml
# $ ansible-playbook -i "192.168.1.155," playbook.yml
# $ ansible-playbook -i inventory.ini playbook.yml
#
###############################################################################

- name: Generate /etc/ssh/ host keys
  command: ssh-keygen -A
  tags:
    - amibuild
  when: ansible_distribution == 'OracleLinux'

- name: Enabled authselect {{ authselect_profile }} profile
  command: authselect select {{ authselect_profile }} --force --quiet
  tags:
    - amibuild
  when: ansible_distribution == 'OracleLinux'

# run stig hardening
- import_tasks: stig_oracle-linux_8.yml
  tags:
    - amibuild
  when: ansible_distribution == 'OracleLinux'
