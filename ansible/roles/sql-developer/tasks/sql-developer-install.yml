---
- name: Create download directory
  ansible.windows.win_file:
    path: "C:\\temp"
    state: directory

- name: install awscli v2
  win_shell: msiexec.exe /i https://awscli.amazonaws.com/AWSCLIV2.msi /qn

- name: copy from s3
  win_shell: |
    cd "C:\Program Files\Amazon\AWSCLIV2"  
    .\aws s3 cp --quiet s3://{{ image_builder_s3_bucket_name }}/{{ s3_folder }}/{{ oracle_sql_developer_installer }} C:\\temp\\sqldeveloper.zip
  register: sqldeveloper_get_result

- name: Unzip Oracle SQL Developer
  win_unzip:
    src: "C:\\temp\\sqldeveloper.zip"
    dest: "C:\\Program Files\\Oracle"
    delete_archive: true

- name: Add SQL Developer to PATH
  ansible.windows.win_path:
    elements:
      - "C:\\Program Files\\Oracle\\sqldeveloper\\sqldeveloper.exe"
    state: present
    scope: machine

- name: Add SQL Developer desktop shortcut
  win_shortcut:
    src: "C:\\Program Files\\Oracle\\sqldeveloper\\sqldeveloper.exe"
    dest: "C:\\Users\\Public\\Desktop\\Oracle SQL Developer.lnk"
    description: "Oracle SQL Developer"
    icon: "C:\\Program Files\\Oracle\\sqldeveloper\\icon.png"