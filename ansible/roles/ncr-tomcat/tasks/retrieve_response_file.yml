- name: Download Response File from S3
  aws_s3:
    mode: get
    bucket: "{{ s3.bip_bucket_name }}"
    object: "{{ s3.response_files_prefix }}{{ s3.files.tomcat_admin_response_file }}"
    dest: "{{ sap_bi_platform_extraction_directory }}/tomcat_response.ini"
    overwrite: true

- name: Ensure product key is set in response file
  ansible.builtin.lineinfile:
    path: "{{ sap_bi_platform_extraction_directory }}/response.ini"
    regexp: "^productkey="
    line: "productkey={{ tomcat_product_key }}"

- name: Ensure CMS password is set in response file
  ansible.builtin.lineinfile:
    path: "{{ sap_bi_platform_extraction_directory }}/response.ini"
    regexp: "^remotecmsadminpassword="
    line: "remotecmsadminpassword={{ tomcat_cms_password }}"
