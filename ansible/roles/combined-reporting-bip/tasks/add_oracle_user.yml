---
- name: Ensure oinstall group exists
  ansible.builtin.group:
    name: oinstall
    state: present

- name: Ensure dba group exists
  ansible.builtin.group:
    name: dba
    state: present

- name: Add the Oracle user
  ansible.builtin.user:
    name: oracle
    comment: Oracle
    groups: oinstall,dba,wheel
    password: "{{ 'password' | password_hash('sha512') }}"
    home: /home/oracle oracle

- name: Assign 775 oracle permissions
  ansible.builtin.file:
    path: "{{ item }}"
    owner: oracle
    group: oinstall
    mode: '0775'
  loop:
    - /u01/stage/
    - /u01/app/oracle/

- name: Assign 770 oracle permissions
  ansible.builtin.file:
    path: /u01/app/oraInventory/
    owner: oracle
    group: oinstall
    mode: '0770'