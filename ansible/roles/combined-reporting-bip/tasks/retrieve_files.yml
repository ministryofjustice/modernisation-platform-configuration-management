---
- name: Download BI Platform from S3
  aws_s3:
    mode: get
    bucket: "{{ bip_bucket_name }}"
    object: "BIP/{{ item }}"
    dest: "{{ sap_bi_platform_unpack_base_directory }}/{{ item|basename }}"
    overwrite: false
  with_items: "{{ sap_bi_platform_platform_files }}"

- name: Download Host Agent from S3
  aws_s3:
    mode: get
    bucket: "{{ bip_bucket_name }}"
    object: "BIP/{{ item }}"
    dest: "{{ sap_host_agent_base_directory }}/{{ item|basename }}"
    overwrite: false
  with_items: "{{ sap_host_agent_files }}"

- name: Hacky rename
  shell: |
    for f in *;
      do
        e="${f##*.}";
        b="${f%.*}";
        mv -n "$f" "${b}.${e,,}";
      done
  args:
    chdir: "{{ sap_bi_platform_unpack_base_directory }}"
    executable: /bin/bash
