---
# included to prevent having to debug connections in the actual task if the target is not reachable
- import_tasks: "misload-connection-check.yml"
  tags:
    - ec2provision
    - ec2patch
  when: ec2.tags['misload-target'] is defined and ansible_facts['distribution'] == "RedHat"

- import_tasks: "misload-config.yml"
  tags:
    - ec2provision
    - ec2patch
  when: ec2.tags['misload-target'] is defined and ansible_facts['distribution'] == "RedHat" and connection_check.rc == 0

# TBD in DSOS-2009
# - import_tasks: "misload-monitoring.yml"
#   tags:
#     - ec2provision
#     - ec2patch
#   when: ec2.tags['misload-target'] is defined and ansible_facts['distribution'] == "RedHat"