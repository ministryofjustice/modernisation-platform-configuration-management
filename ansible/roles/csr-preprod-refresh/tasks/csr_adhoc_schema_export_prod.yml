---
- name: create script directory
  ansible.builtin.file:
    path: "{{ item }}"
    owner: oracle
    group: oinstall
    state: directory
    recurse: yes
  loop:
    - "{{ scripts_dir }}"

- name: copy scripts
  ansible.builtin.template:
    src: "{{ item }}.j2"
    dest: "{{ scripts_dir }}/{{ item }}"
    owner: oracle
    group: oinstall
    mode: "0700"
  loop:
    - "{{ adhoc_export_refresh_script }}"
# - name: Start production export
#   become_user: oracle
#   ansible.builtin.shell: |
#     set -eo pipefail
#     PATH=$PATH:/usr/local/bin
#     main() {
#       nohup {{ scripts_dir }}/{{ adhoc_export_refresh_script }} {{ prod_db_sid }} {{ adhoc_schemas }} {{ db_directory }} {{ EXPDP_TAG }} &
#     }
#     main 2>&1 | logger -p local3.info -t ansible-oracle-db
#   async: 43200
#   poll: 0
